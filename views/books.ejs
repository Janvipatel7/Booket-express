<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>All Books</title>
    <link rel="stylesheet" href="/assets/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css">
    <link rel="stylesheet" href="/assets/css/style.css">

</head>

<body class="form-page">
    <%- include('partials/header') %>
        <section class="container pt-5">
            <h3 class="mb-4 fw-bold page-title">All Books</h3>
            <div class="card table-card shadow-sm">
                <div class="table-responsive">
                    <table class="table table-striped align-middle text-center">
                        <thead class="table-custom">
                            <tr>
                                <th>No</th>
                                <th>Book Name</th>
                                <th>Author</th>
                                <th>Price</th>
                                <th>Publisher Date</th>
                                <th>Genre</th>
                                <th>Format</th>
                                <th>Features</th>
                                <th>Action</th>
                            </tr>
                        </thead>

                        <tbody>
                            <% if (books.length===0) { %>
                                <tr>
                                    <td colspan="9" class="no-data-cell">
                                        <i class="bi bi-folder-x no-data-icon"></i>
                                        <span>No books found.</span>
                                    </td>
                                </tr>
                                <% } else { %>
                                    <% books.map((book, idx)=> { %>
                                        <tr class="border-bottom">
                                            <td>
                                                <%= idx + 1 %>
                                            </td>
                                            <td>
                                                <%= book.bookName %>
                                            </td>
                                            <td>
                                                <%= book.author %>
                                            </td>
                                            <td>â‚¹ <%= book.price %>
                                            </td>
                                            <td>
                                                <%= book.publisherDate %>
                                            </td>
                                            <td>
                                                <%= book.genre %>
                                            </td>
                                            <td>
                                                <%= book.format %>
                                            </td>
                                            <td>
                                                <div class="badge-container">
                                                    <%- book.features.map(item=> `
                                                        <div class="feature-badge">
                                                            <span class="feature-dot"></span>
                                                            ${item}
                                                        </div>
                                                        `).join("") %>
                                                </div>
                                            </td>

                                            <td class="d-flex justify-content-center gap-2">
                                                <a href="/edit-book/<%= book._id %>" class="btn btn-edit">
                                                    <i class="bi bi-pencil-square"></i>
                                                </a>
                                                <button onclick="deleteBook('<%= book._id %>')" class="btn btn-del">
                                                    <i class="bi bi-trash3"></i>
                                                </button>
                                            </td>
                                        </tr>
                                        <% }) %>
                                            <% } %>
                        </tbody>
                    </table>
                </div>
            </div>
        </section>


        <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
        <script>
            const deleteBook = (id) => {
                Swal.fire({
                    title: "Are you sure?",
                    text: "You won't be able to revert this!",
                    icon: "warning",
                    showCancelButton: true,
                    confirmButtonColor: "#3085d6",
                    cancelButtonColor: "#d33",
                    confirmButtonText: "Yes, delete it!"
                }).then((result) => {
                    if (result.isConfirmed) {
                        window.location.href = `/delete-book/${id}`
                    }
                });
            }
        </script>

</body>

</html>